import{r as l,u as F,j as e}from"./index-eNUBUYn0.js";import{A as E}from"./index-cZOPmj8L.js";import{a as g}from"./api-Q4hECNGJ.js";const A=()=>{const[t,i]=l.useState({channelId:"",channelName:"",email:"",commission:"",currency:""}),[p,b]=l.useState([]),[x,y]=l.useState(null),[c,f]=l.useState(null),[N,j]=l.useState(null),[d,v]=l.useState(1),m=l.useRef(null),u=F();l.useEffect(()=>{(async()=>{try{const s=await g({method:"get",url:"admin/settings/currency-list"});b(s.data.listCurrency)}catch(a){console.error("Error fetching currency list:",a)}})()},[]);const r=n=>{const{name:a,value:s}=n.target;i({...t,[a]:s})},C=n=>{const{name:a,value:s}=n.target;i({...t,[a]:s})},w=n=>{const a=n.target.files&&n.target.files[0];if(a){const s=new FileReader;s.onload=()=>{s.result&&(y(a),j(s.result))},s.readAsDataURL(a)}},I=async n=>{var s;n.preventDefault(),console.log("Form submitted with values:",t);const a=new FormData;if(a.append("channelId",t.channelId),a.append("channelName",t.channelName),a.append("email",t.email),a.append("commission",t.commission),a.append("currency",t.currency),c)console.log("formdata image append",c),a.append("logo",c);else return alert("There is no picture or u forgot to press crop"),null;console.log(Object.fromEntries(a));try{console.log("axios calling - ");const o=await g({method:"post",url:"admin/add-channel",data:a});console.log(o),((s=o==null?void 0:o.data)==null?void 0:s.status)=="success"&&(alert("Channel added successfully"),u("/channels"))}catch(h){alert("Internal server issue"),console.error("Error submitting form:",h)}},k=()=>{if(m.current){const a=m.current.getImageScaledToCanvas().toDataURL("image/jpeg");console.log("Cropped image:",a),f(a)}},S=n=>{v(parseFloat(n.target.value))};return e.jsxs("div",{className:"p-6 bg-gray-100 rounded-lg shadow-md",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Add Channel"}),e.jsxs("form",{onSubmit:I,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"channelId",className:"block text-sm font-medium text-gray-700",children:"Channel ID"}),e.jsx("input",{type:"text",id:"channelId",name:"channelId",value:t.channelId,onChange:r,className:"mt-1 p-2 block w-1/2 lg:w-1/2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"channelName",className:"block text-sm font-medium text-gray-700",children:"Channel Name"}),e.jsx("input",{type:"text",id:"channelName",name:"channelName",value:t.channelName,onChange:r,className:"mt-1 p-2 block w-1/2 lg:w-1/2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",id:"email",name:"email",value:t.email,onChange:r,className:"mt-1 p-2 block w-1/2 lg:w-1/2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"commission",className:"block text-sm font-medium text-gray-700",children:"Commission"}),e.jsx("input",{type:"number",id:"commission",name:"commission",value:t.commission,onChange:r,className:"mt-1 p-2 block w-1/2 lg:w-1/2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700",children:"Currency Type"}),e.jsxs("select",{id:"currency",name:"currency",value:t.currency,onChange:C,className:"mt-1 p-2 block w-1/2 lg:w-1/2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"",children:"Select currency"}),p.map(n=>e.jsx("option",{value:n.currencyName,children:n.currencyName},n._id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"logo",className:"block text-sm font-medium text-gray-700",children:"Logo"}),e.jsx("input",{type:"file",id:"logo",name:"logo",accept:"image/*",onChange:w,className:"mt-1 p-2 block w-1/2 lg:w-1/2 border border-gray-300 rounded-md"}),x&&e.jsxs("div",{className:"m-4 text-center flex-col",children:[e.jsx(E,{className:"flex justify-start",ref:m,image:N,width:200,height:200,border:10,borderRadius:100,scale:d}),e.jsxs("div",{className:"flex-row flex justify-start m-4",children:[e.jsx("input",{className:"mr-2",type:"range",min:"1",max:"2",step:"0.01",value:d,onChange:S}),e.jsx("button",{type:"button",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",onClick:k,children:"Crop"})]})]})]}),e.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Submit"}),e.jsx("button",{type:"button",onClick:()=>u("/channels"),className:"ml-2 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Cancel"})]})]})};export{A as default};
