import{r as l,u as F,a as D,j as e}from"./index-eNUBUYn0.js";import{A as R}from"./index-cZOPmj8L.js";import{a as u}from"./api-Q4hECNGJ.js";const P=()=>{const[s,m]=l.useState({_id:"",channelId:"",channelName:"",email:"",commission:"",currency:""}),[b,x]=l.useState([]),[y,f]=l.useState(null),[i,N]=l.useState(null),[j,v]=l.useState(null),[h,C]=l.useState(1),d=l.useRef(null),g=F(),{id:p}=D();console.log("ID is that : "+p),l.useEffect(()=>{const t=async()=>{try{const n={method:"get",url:`admin/channel/${p}`},o=await u(n);m(o.data.channelData),console.log("response : ",o.data)}catch(n){console.error("Error fetching channels:",n)}};(async()=>{try{const o=await u({method:"get",url:"admin/settings/currency-list"});x(o.data.listCurrency)}catch(n){console.error("Error fetching currency list:",n)}})(),t()},[]),console.log("state values : ",s);const r=t=>{const{name:a,value:n}=t.target;m({...s,[a]:n})},w=t=>{const{name:a,value:n}=t.target;m({...s,[a]:n})},I=t=>{const a=t.target.files&&t.target.files[0];if(a){const n=new FileReader;n.onload=()=>{n.result&&(f(a),v(n.result))},n.readAsDataURL(a)}},k=async t=>{var n;t.preventDefault(),console.log("Form submitted with values:",s);const a=new FormData;a.append("channelId",s.channelId),a.append("channelName",s.channelName),a.append("email",s.email),a.append("commission",s.commission),a.append("currency",s.currency),a.append("_id",s._id),i&&(console.log("formdata image append",i),a.append("logo",i));try{console.log("axios calling - ",a);const c=await u({method:"post",url:"admin/edit-channel",data:a});console.log(c),((n=c==null?void 0:c.data)==null?void 0:n.status)=="success"&&(alert("Channel added successfully"),g("/channels"))}catch(o){console.error("Error submitting form:",o)}},S=()=>{if(d.current){const a=d.current.getImageScaledToCanvas().toDataURL("image/jpeg");console.log("Cropped image:",a),N(a)}},E=t=>{C(parseFloat(t.target.value))};return e.jsx("div",{children:e.jsxs("div",{className:"p-6 bg-gray-100 rounded-lg shadow-md",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Edit Channel"}),e.jsxs("form",{onSubmit:k,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"channelId",className:"block text-sm font-medium text-gray-700",children:"Channel ID"}),e.jsx("input",{type:"text",id:"channelId",name:"channelId",value:s.channelId,onChange:r,className:"mt-1 p-2 block w-1/2 lg:w-1/2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"channelName",className:"block text-sm font-medium text-gray-700",children:"Channel Name"}),e.jsx("input",{type:"text",id:"channelName",name:"channelName",value:s.channelName,onChange:r,className:"mt-1 p-2 block w-1/2 lg:w-1/2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",id:"email",name:"email",value:s.email,onChange:r,className:"mt-1 p-2 block w-1/2 lg:w-1/2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"commission",className:"block text-sm font-medium text-gray-700",children:"Commission"}),e.jsx("input",{type:"number",id:"commission",name:"commission",value:s.commission,onChange:r,className:"mt-1 p-2 block w-1/2 lg:w-1/2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700",children:"Currency Type"}),e.jsxs("select",{id:"currency",name:"currency",value:s.currency,onChange:w,className:"mt-1 p-2 block w-1/2 lg:w-1/2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"",children:"Select currency"}),b.map(t=>e.jsx("option",{value:t.currencyName,children:t.currencyName},t._id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"logo",className:"block text-sm font-medium text-gray-700",children:"Logo"}),e.jsx("input",{type:"file",id:"logo",name:"logo",accept:"image/*",onChange:I,className:"mt-1 p-2 block w-1/2 lg:w-1/2 border border-gray-300 rounded-md"}),y&&e.jsxs("div",{className:"m-4 text-center flex-col",children:[e.jsx(R,{className:"flex justify-start",ref:d,image:j,width:200,height:200,border:10,borderRadius:100,scale:h}),e.jsxs("div",{className:"flex-row flex justify-start m-4",children:[e.jsx("input",{className:"mr-2",type:"range",min:"1",max:"2",step:"0.01",value:h,onChange:E}),e.jsx("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",onClick:S,children:"Crop"})]})]})]}),e.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Submit"}),e.jsx("button",{type:"button",onClick:()=>g("/channels"),className:"ml-2 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Cancel"})]})]})})};export{P as default};
